{"version":3,"file":"ajaxforms.min.js","sources":["../src/ajaxforms.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n/**\n * Add a create new group modal to the page.\n *\n * @module     block_learnerscript/ajaxforms\n * @class      AjaxForms\n * @package\n * @copyright  2023 Moodle India Information Solutions Private Limited\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery',\n        'core/str',\n        'core/modal_factory',\n        'core/modal_events',\n        'core/fragment',\n        'block_learnerscript/ajax',\n        'block_learnerscript/schedule',\n        'block_learnerscript/select2/select2',\n        'core/yui',\n        'core/templates',\n        'core/modal',\n        'block_learnerscript/helper',\n        'jqueryui'\n        ],\n    function($, Str, ModalFactory, ModalEvents, Fragment, Ajax, schedule, select2, Y, Templates, Modal, helper) {\n\n        /**\n         * Constructor\n         *\n         * @param {Object} args Contains list of parameters.\n         * @param {string} url Ajax request URL.\n         *\n         * Each call to init gets it's own instance of this class.\n         */\n        var AjaxForms = function(args, url) {\n            this.args = args;\n            this.contextid = 1;\n            this.url = url;\n            this.nodeContent = args.nodeContent || 'ajaxForm';\n            this.init(this.args);\n        };\n\n        /**\n         * @var {Modal} modal\n         * @private\n         */\n        AjaxForms.prototype.modal = null;\n\n        /**\n         * @var {int} contextid\n         * @private\n         */\n        AjaxForms.prototype.contextid = -1;\n\n        /**\n         * Initialise the class.\n         *\n         * @param {String} args used to find triggers for the new group modal.\n         * @private\n         * @return {Promise}\n         */\n        AjaxForms.prototype.init = function(args) {\n            var resp = this.getBody();\n            var self = this;\n            var dialogueclass = \"\";\n            resp.done(function(data) {\n                $('body').append(\"<div class='\" + self.nodeContent + \"'></div>\");\n                Templates.replaceNodeContents('.' + self.nodeContent, data.html, '');\n                var title_img = '';\n                var position = '#viewreport' + args.reportid;\n                var width = '80%';\n                var my = \"center top\";\n                var at = \"center top\";\n                if (args.action == 'schreportform') {\n                    dialogueclass = 'schreportform';\n                    title_img = \"<img class='dialog_title_icon' alt='Schedule' src='\" +\n                        M.util.image_url(\"schreportform\", \"block_learnerscript\") + \"' />\";\n                    position = \"#inst\" + args.instanceid;\n                    width = '60%';\n                    my = \"center\";\n                    at =  \"center\";\n                } else if (args.action == 'advancedcolumns') {\n                    dialogueclass = 'advancedcolumns';\n                    position = \".ls_components\";\n                    width = '60%';\n                    my = \"center top\";\n                    at =  \"center top\";\n                } else if (args.action == 'sendreportemail') {\n                    dialogueclass = 'sendreportemail';\n                    title_img = \"<img class='dialog_title_icon' alt='Email' src='\" +\n                        M.util.image_url(\"email_icon\", \"block_learnerscript\") + \"'/>\";\n                    position = \"#inst\" + args.instanceid;\n                    width = '60%';\n                    my = \"center\";\n                    at = \"center\";\n                }\n\n                $('head').append(data.javascript);\n\n                var dlg = $(\".\" + self.nodeContent).dialog({\n                    resizable: true,\n                    autoOpen: false,\n                    width: width,\n                    dialogClass: dialogueclass,\n                    title: self.args.title,\n                    modal: true,\n                    appendTo: position,\n                    position: {\n                        my: my,\n                        at: at,\n                        of: position,\n                        within: position\n                    },\n                    close: function() {\n                        $(this).dialog('destroy').remove();\n                    },\n                    open: function() {\n                         $(this).closest(\".ui-dialog\")\n                                .find(\".ui-dialog-titlebar-close\")\n                                .removeClass(\"ui-dialog-titlebar-close\")\n                                .html(\"<span class='ui-button-icon-primary ui-icon ui-icon-closethick'></span>\");\n                            var Closebutton = $('.ui-icon-closethick').parent();\n                            Str.get_string('close', 'block_learnerscript').then(function(s) {\n                                $(Closebutton).attr({\n                                    \"title\": s\n                                });\n                            });\n                        $(this).closest(\".ui-dialog\")\n                               .find('.ui-dialog-title').html(title_img + self.args.title);\n                    }\n                });\n                if (args.action == 'schreportform') {\n                    $(\".\" + self.nodeContent + \" select[data-select2='1']\").select2();\n                    schedule.SelectRoleUsers();\n                } else if (args.action == 'sendreportemail') {\n                    helper = require('block_learnerscript/helper');\n                    helper.Select2Ajax({\n                        'action': 'userlist',\n                        'reportid': args.reportid,\n                        'maximumselectionlength': 0\n                    });\n                }\n                $('.' + self.nodeContent + ' .mform').bind('submit', function(e) {\n                    e.preventDefault();\n                    return self.submitFormAjax(this);\n                });\n\n                if (args.action == 'plotforms' && (args.pname == 'bar' || args.pname == 'column'\n                || args.pname == 'line' || args.pname == 'combination')) {\n\n                    $(\".\" + self.nodeContent + \" select[data-select2='1']\").select2({\n                        theme: \"classic\"\n                    });\n                    $(document).on('click', '.fa-eye', function(e) {\n                        e.stopImmediatePropagation();\n                        $(e.target).parents('.form-group').find('*').attr('disabled', true);\n                        $(e.target).switchClass(\"fa-eye\", \"fa-eye-slash\");\n                        $(e.target).attr('title', 'Enable');\n                    });\n                    $(document).on('click', '.fa-eye-slash', function(e) {\n                        e.stopImmediatePropagation();\n                        $(e.target).parents('.form-group').find('*').removeAttr('disabled');\n                        $(e.target).switchClass(\"fa-eye-slash\", \"fa-eye\");\n                        $(e.target).attr('title', 'Disable');\n                    });\n                    $(document).on('change', '#id_calcs', function() {\n                        var calcval = $(this).val();\n                        if (calcval) {\n                            $('#id_columnsort').prop(\"disabled\", true);\n                            $('#id_sorting').prop(\"disabled\", true);\n                            $('#id_limit').prop(\"disabled\", true);\n                        } else {\n                            $('#id_columnsort').prop(\"disabled\", false);\n                            $('#id_sorting').prop(\"disabled\", false);\n                            $('#id_limit').prop(\"disabled\", false);\n                        }\n                    });\n                }\n\n                dlg.dialog(\"open\");\n            }).fail(function() {\n\n            });\n\n        };\n\n        /**\n         * @param {formdata} formdata\n         * @method getBody\n         * @private\n         * @return {Promise}\n         */\n        AjaxForms.prototype.getBody = function(formdata) {\n            if (typeof formdata === \"undefined\") {\n                formdata = null;\n            } else {\n                // Get the content of the modal.\n                this.args.jsonformdata = JSON.stringify(formdata);\n            }\n\n            var promise = Ajax.call({\n                args: this.args,\n                url: this.url\n            }, false);\n\n            return promise;\n        };\n\n        /**\n         * @param {data} data\n         * @method handleFormSubmissionResponse\n         * @private\n         */\n        AjaxForms.prototype.handleFormSubmissionResponse = function(data) {\n            var helper = require('block_learnerscript/helper');\n            if (data.formerror) {\n                Templates.replaceNodeContents('.' + this.nodeContent, data.html, '');\n                $('head').append(data.javascript);\n\n                var self = this;\n                $('.' + this.nodeContent + ' .mform').bind('submit', function(e) {\n                    e.preventDefault();\n                    self.submitFormAjax(this);\n                });\n                if (this.args.action == 'schreportform') {\n                    $(\".\" + self.nodeContent + \" select[data-select2='1']\").select2();\n                    schedule.SelectRoleUsers();\n                } else if (this.args.action == 'sendreportemail') {\n                    helper = require('block_learnerscript/helper');\n                    helper.Select2Ajax({\n                        'action': 'userlist',\n                        'reportid': this.args.reportid,\n                        'maximumselectionlength': 0\n                    });\n                } else {\n                    $(\".\" + self.nodeContent + \" select[data-select2='1']\").select2({\n                        theme: \"classic\"\n                    });\n                }\n            } else {\n                if (this.args.component == 'columns') {\n                    var app = angular.element(\".simpleDemo\").scope();\n                    var pluginname = this.args.advancedcolumn;\n                    app.$apply(function() {\n                        var plugindata = {};\n                        plugindata.id = data.data.id;\n                        delete data.data.id;\n                        plugindata.pluginname = pluginname;\n                        plugindata.pluginfullname = pluginname;\n                        plugindata.summary = '';\n                        plugindata.type = 'selectedcolumns';\n                        plugindata.formdata = data.data;\n                        app.lists.columns.elements.push(plugindata);\n                    });\n\n                    $(\".\" + this.nodeContent).dialog('destroy').remove();\n                } else {\n                    if (this.args.action == 'schreportform') {\n                        $(\".\" + this.nodeContent).dialog('close');\n                        Str.get_string('reportschedule', 'block_learnerscript').then(function(s) {\n                            helper.notifications(s);\n                        });\n                    } else if (this.args.action == 'plotforms') {\n                        var self = this;\n                        $(\".\" + this.nodeContent).dialog('close');\n                        Str.get_strings([{\n                            key: 'graphcreated',\n                            component: 'block_learnerscript'\n                        }, {\n                            key: 'graphupdated',\n                            component: 'block_learnerscript'\n                        }]).then(function(s) {\n                            var cid;\n                            var templatename;\n                            var tabdata;\n                            if (self.args.type == 'add') {\n                                helper.notifications(s[0]);\n                                var reportid = self.args.reportid;\n                                cid = data.data.id;\n                                var CreateDashboardwidget = {};\n                                CreateDashboardwidget.reportid = reportid;\n                                CreateDashboardwidget.chartid = data.data.id;\n                                CreateDashboardwidget.reporttype = data.data.id;\n                                CreateDashboardwidget.pluginname = self.args.pname;\n                                CreateDashboardwidget.chartname = data.data.chartname;\n                                CreateDashboardwidget.issiteadmin = true;\n                                CreateDashboardwidget.editicon = M.util.image_url(\"t/edit\");\n                                Str.get_string(self.args.pname , 'block_learnerscript').then(function(s){\n                                    CreateDashboardwidget.title = s ;\n                                });\n                                CreateDashboardwidget.cid = data.data.id;\n                                CreateDashboardwidget.pname = self.args.pname;\n                                CreateDashboardwidget.type = 'edit';\n                                CreateDashboardwidget.deleteicon = M.util.image_url(\"t/delete\") ;\n                                CreateDashboardwidget.pname = self.args.pname;\n                                CreateDashboardwidget.type = 'edit';\n                                if ($('#report_plottabs').length > 0) {\n                                    templatename = 'block_learnerscript/tabs';\n                                    tabdata = CreateDashboardwidget;\n                                } else {\n                                    templatename = 'block_learnerscript/plottabs';\n                                    var CreateDashboardwidgetargs = {};\n                                    CreateDashboardwidgetargs.reportid = reportid;\n                                    CreateDashboardwidgetargs.multiplot = true;\n                                    CreateDashboardwidgetargs.enableplots = false;\n                                    CreateDashboardwidgetargs.plottabs = CreateDashboardwidget;\n                                    tabdata = CreateDashboardwidgetargs;\n                                }\n\n                                Templates.render(templatename, tabdata).done(function(tab) {\n                                    if ($('#report_plottabs').length > 0) {\n                                        $(\"span#report_plottabs ul\").append(tab);\n                                    } else {\n                                        $(\"span.filter_buttons\").prepend(tab);\n                                    }\n\n                                    $('.plotgraphcontainer').removeClass('show').addClass('hide');\n                                    $('#plotreportcontainer' + reportid).html('');\n                                });\n                            } else if (self.args.type == 'edit') {\n                                helper.notifications(s[1]);\n                                cid = self.args.cid;\n                                $('#lschartname' + cid).text(data.data.chartname);\n                                $('#' + cid).trigger('click');\n                            }\n                        });\n                    }  else if (this.args.action == 'sendreportemail') {\n                        $(\".\" + this.nodeContent).dialog('close');\n                        Str.get_string('mailscheduled', 'block_learnerscript').then(function(s) {\n                            helper.notifications(s);\n                        });\n                    } else {\n                        window.location.reload();\n                    }\n                }\n            }\n\n        };\n\n        /**\n         * @method handleFormSubmissionFailure\n         * @private\n         */\n        AjaxForms.prototype.handleFormSubmissionFailure = function() {\n\n        };\n\n        /**\n         * Private method\n         *\n         * @method submitFormAjax\n         * @param {form} form\n         * @return {object}\n         * @private\n         */\n        AjaxForms.prototype.submitFormAjax = function(form) {\n            if (skipClientValidation) {\n                $('.' + this.nodeContent).dialog('destroy').remove();\n                return true;\n            }\n            // We don't want to do a real form submission.\n            // Convert all the form elements values to a serialised string.\n            this.args.jsonformdata = $(form).serialize();\n            var self = this;\n            var promise = Ajax.call({\n                args: this.args,\n                url: this.url\n            });\n            promise.done(function(response) {\n                return self.handleFormSubmissionResponse(response);\n            }).fail(function() {\n            });\n        };\n\n        /**\n         * This triggers a form submission, so that any mform elements can do final tricks before the form submission is processed.\n         *\n         * @method submitForm\n         * @param {Event} e Form submission event.\n         * @private\n         */\n        AjaxForms.prototype.submitForm = function(e) {\n            e.preventDefault();\n            this.modal.getRoot().find('form').submit();\n        };\n\n        return /** @alias module:core_group/AjaxForms */ {\n            // Public variables and functions.\n            /**\n             * Attach event listeners to initialise this module.\n             *\n             * @method init\n             * @param {object} args The CSS selector used to find nodes that will trigger this module.\n             * @param {string} url Ajax request URL.\n             * @return {Promise}\n             */\n            init: function(args, url) {\n                return new AjaxForms(args, url);\n            }\n        };\n    });\n"],"names":["define","$","Str","ModalFactory","ModalEvents","Fragment","Ajax","schedule","select2","Y","Templates","Modal","helper","AjaxForms","args","url","this","contextid","nodeContent","init","prototype","modal","resp","getBody","self","dialogueclass","done","data","append","replaceNodeContents","html","title_img","position","reportid","width","my","at","action","M","util","image_url","instanceid","javascript","dlg","dialog","resizable","autoOpen","dialogClass","title","appendTo","of","within","close","remove","open","closest","find","removeClass","Closebutton","parent","get_string","then","s","attr","SelectRoleUsers","require","Select2Ajax","maximumselectionlength","bind","e","preventDefault","submitFormAjax","pname","theme","document","on","stopImmediatePropagation","target","parents","switchClass","removeAttr","val","prop","fail","formdata","jsonformdata","JSON","stringify","call","handleFormSubmissionResponse","formerror","component","app","angular","element","scope","pluginname","advancedcolumn","$apply","plugindata","id","pluginfullname","summary","type","lists","columns","elements","push","notifications","get_strings","key","cid","templatename","tabdata","CreateDashboardwidget","chartid","reporttype","chartname","issiteadmin","editicon","deleteicon","length","CreateDashboardwidgetargs","multiplot","enableplots","plottabs","render","tab","prepend","addClass","text","trigger","window","location","reload","handleFormSubmissionFailure","form","skipClientValidation","serialize","response","submitForm","getRoot","submit"],"mappings":";;;;;;;;;AAuBAA,uCAAO,CAAC,SACA,WACA,qBACA,oBACA,gBACA,2BACA,+BACA,sCACA,WACA,iBACA,aACA,6BACA,aAEJ,SAASC,EAAGC,IAAKC,aAAcC,YAAaC,SAAUC,KAAMC,SAAUC,QAASC,EAAGC,UAAWC,MAAOC,QAUhG,IAAIC,UAAY,SAASC,KAAMC,KAC3BC,KAAKF,KAAOA,KACZE,KAAKC,UAAY,EACjBD,KAAKD,IAAMA,IACXC,KAAKE,YAAcJ,KAAKI,aAAe,WACvCF,KAAKG,KAAKH,KAAKF,OA2VnB,OApVAD,UAAUO,UAAUC,MAAQ,KAM5BR,UAAUO,UAAUH,WAAa,EASjCJ,UAAUO,UAAUD,KAAO,SAASL,MAChC,IAAIQ,KAAON,KAAKO,UACZC,KAAOR,KACPS,cAAgB,GACpBH,KAAKI,MAAK,SAASC,MACf1B,EAAE,QAAQ2B,OAAO,eAAiBJ,KAAKN,YAAc,YACrDR,UAAUmB,oBAAoB,IAAML,KAAKN,YAAaS,KAAKG,KAAM,IACjE,IAAIC,UAAY,GACZC,SAAW,cAAgBlB,KAAKmB,SAChCC,MAAQ,MACRC,GAAK,aACLC,GAAK,aACU,iBAAftB,KAAKuB,QACLZ,cAAgB,gBAChBM,UAAY,sDACRO,EAAEC,KAAKC,UAAU,gBAAiB,uBAAyB,OAC/DR,SAAW,QAAUlB,KAAK2B,WAC1BP,MAAQ,MACRC,GAAK,SACLC,GAAM,UACgB,mBAAftB,KAAKuB,QACZZ,cAAgB,kBAChBO,SAAW,iBACXE,MAAQ,MACRC,GAAK,aACLC,GAAM,cACgB,mBAAftB,KAAKuB,SACZZ,cAAgB,kBAChBM,UAAY,mDACRO,EAAEC,KAAKC,UAAU,aAAc,uBAAyB,MAC5DR,SAAW,QAAUlB,KAAK2B,WAC1BP,MAAQ,MACRC,GAAK,SACLC,GAAK,UAGTnC,EAAE,QAAQ2B,OAAOD,KAAKe,YAEtB,IAAIC,IAAM1C,EAAE,IAAMuB,KAAKN,aAAa0B,OAAO,CACvCC,WAAW,EACXC,UAAU,EACVZ,MAAOA,MACPa,YAAatB,cACbuB,MAAOxB,KAAKV,KAAKkC,MACjB3B,OAAO,EACP4B,SAAUjB,SACVA,SAAU,CACNG,GAAIA,GACJC,GAAIA,GACJc,GAAIlB,SACJmB,OAAQnB,UAEZoB,MAAO,WACHnD,EAAEe,MAAM4B,OAAO,WAAWS,UAE9BC,KAAM,WACDrD,EAAEe,MAAMuC,QAAQ,cACRC,KAAK,6BACLC,YAAY,4BACZ3B,KAAK,2EACV,IAAI4B,YAAczD,EAAE,uBAAuB0D,SAC3CzD,IAAI0D,WAAW,QAAS,uBAAuBC,MAAK,SAASC,GACzD7D,EAAEyD,aAAaK,KAAK,CAChBf,MAASc,OAGrB7D,EAAEe,MAAMuC,QAAQ,cACRC,KAAK,oBAAoB1B,KAAKC,UAAYP,KAAKV,KAAKkC,UAGjD,iBAAflC,KAAKuB,QACLpC,EAAE,IAAMuB,KAAKN,YAAc,6BAA6BV,UACxDD,SAASyD,mBACa,mBAAflD,KAAKuB,QACH4B,QAAQ,8BACVC,YAAY,CACf7B,OAAU,WACVJ,SAAYnB,KAAKmB,SACjBkC,uBAA0B,IAGlClE,EAAE,IAAMuB,KAAKN,YAAc,WAAWkD,KAAK,UAAU,SAASC,GAE1D,OADAA,EAAEC,iBACK9C,KAAK+C,eAAevD,SAGZ,aAAfF,KAAKuB,QAAwC,OAAdvB,KAAK0D,OAAgC,UAAd1D,KAAK0D,OAC9C,QAAd1D,KAAK0D,OAAiC,eAAd1D,KAAK0D,QAE5BvE,EAAE,IAAMuB,KAAKN,YAAc,6BAA6BV,QAAQ,CAC5DiE,MAAO,YAEXxE,EAAEyE,UAAUC,GAAG,QAAS,WAAW,SAASN,GACxCA,EAAEO,2BACF3E,EAAEoE,EAAEQ,QAAQC,QAAQ,eAAetB,KAAK,KAAKO,KAAK,YAAY,GAC9D9D,EAAEoE,EAAEQ,QAAQE,YAAY,SAAU,gBAClC9E,EAAEoE,EAAEQ,QAAQd,KAAK,QAAS,aAE9B9D,EAAEyE,UAAUC,GAAG,QAAS,iBAAiB,SAASN,GAC9CA,EAAEO,2BACF3E,EAAEoE,EAAEQ,QAAQC,QAAQ,eAAetB,KAAK,KAAKwB,WAAW,YACxD/E,EAAEoE,EAAEQ,QAAQE,YAAY,eAAgB,UACxC9E,EAAEoE,EAAEQ,QAAQd,KAAK,QAAS,cAE9B9D,EAAEyE,UAAUC,GAAG,SAAU,aAAa,WACpB1E,EAAEe,MAAMiE,OAElBhF,EAAE,kBAAkBiF,KAAK,YAAY,GACrCjF,EAAE,eAAeiF,KAAK,YAAY,GAClCjF,EAAE,aAAaiF,KAAK,YAAY,KAEhCjF,EAAE,kBAAkBiF,KAAK,YAAY,GACrCjF,EAAE,eAAeiF,KAAK,YAAY,GAClCjF,EAAE,aAAaiF,KAAK,YAAY,QAK5CvC,IAAIC,OAAO,WACZuC,MAAK,gBAYZtE,UAAUO,UAAUG,QAAU,SAAS6D,UAanC,YAZwB,IAAbA,SACPA,SAAW,KAGXpE,KAAKF,KAAKuE,aAAeC,KAAKC,UAAUH,UAG9B9E,KAAKkF,KAAK,CACpB1E,KAAME,KAAKF,KACXC,IAAKC,KAAKD,MACX,IAUPF,UAAUO,UAAUqE,6BAA+B,SAAS9D,MACxD,IAAIf,OAASqD,QAAQ,8BACrB,GAAItC,KAAK+D,UAAW,CAChBhF,UAAUmB,oBAAoB,IAAMb,KAAKE,YAAaS,KAAKG,KAAM,IACjE7B,EAAE,QAAQ2B,OAAOD,KAAKe,YAEtB,IAAIlB,KAAOR,KACXf,EAAE,IAAMe,KAAKE,YAAc,WAAWkD,KAAK,UAAU,SAASC,GAC1DA,EAAEC,iBACF9C,KAAK+C,eAAevD,SAEA,iBAApBA,KAAKF,KAAKuB,QACVpC,EAAE,IAAMuB,KAAKN,YAAc,6BAA6BV,UACxDD,SAASyD,mBACkB,mBAApBhD,KAAKF,KAAKuB,QACjBzB,OAASqD,QAAQ,+BACVC,YAAY,CACf7B,OAAU,WACVJ,SAAYjB,KAAKF,KAAKmB,SACtBkC,uBAA0B,IAG9BlE,EAAE,IAAMuB,KAAKN,YAAc,6BAA6BV,QAAQ,CAC5DiE,MAAO,iBAIf,GAA2B,WAAvBzD,KAAKF,KAAK6E,UAAwB,CAClC,IAAIC,IAAMC,QAAQC,QAAQ,eAAeC,QACrCC,WAAahF,KAAKF,KAAKmF,eAC3BL,IAAIM,QAAO,WACP,IAAIC,WAAa,GACjBA,WAAWC,GAAKzE,KAAKA,KAAKyE,UACnBzE,KAAKA,KAAKyE,GACjBD,WAAWH,WAAaA,WACxBG,WAAWE,eAAiBL,WAC5BG,WAAWG,QAAU,GACrBH,WAAWI,KAAO,kBAClBJ,WAAWf,SAAWzD,KAAKA,KAC3BiE,IAAIY,MAAMC,QAAQC,SAASC,KAAKR,eAGpClG,EAAE,IAAMe,KAAKE,aAAa0B,OAAO,WAAWS,cAE5C,GAAwB,iBAApBrC,KAAKF,KAAKuB,OACVpC,EAAE,IAAMe,KAAKE,aAAa0B,OAAO,SACjC1C,IAAI0D,WAAW,iBAAkB,uBAAuBC,MAAK,SAASC,GAClElD,OAAOgG,cAAc9C,WAEtB,GAAwB,aAApB9C,KAAKF,KAAKuB,OAAuB,CACpCb,KAAOR,KACXf,EAAE,IAAMe,KAAKE,aAAa0B,OAAO,SACjC1C,IAAI2G,YAAY,CAAC,CACbC,IAAK,eACLnB,UAAW,uBACZ,CACCmB,IAAK,eACLnB,UAAW,yBACX9B,MAAK,SAASC,GACd,IAAIiD,IACAC,aACAC,QACJ,GAAsB,OAAlBzF,KAAKV,KAAKyF,KAAe,CACzB3F,OAAOgG,cAAc9C,EAAE,IACvB,IAAI7B,SAAWT,KAAKV,KAAKmB,SACzB8E,IAAMpF,KAAKA,KAAKyE,GAChB,IAAIc,sBAAwB,GAiB5B,GAhBAA,sBAAsBjF,SAAWA,SACjCiF,sBAAsBC,QAAUxF,KAAKA,KAAKyE,GAC1Cc,sBAAsBE,WAAazF,KAAKA,KAAKyE,GAC7Cc,sBAAsBlB,WAAaxE,KAAKV,KAAK0D,MAC7C0C,sBAAsBG,UAAY1F,KAAKA,KAAK0F,UAC5CH,sBAAsBI,aAAc,EACpCJ,sBAAsBK,SAAWjF,EAAEC,KAAKC,UAAU,UAClDtC,IAAI0D,WAAWpC,KAAKV,KAAK0D,MAAQ,uBAAuBX,MAAK,SAASC,GAClEoD,sBAAsBlE,MAAQc,KAElCoD,sBAAsBH,IAAMpF,KAAKA,KAAKyE,GACtCc,sBAAsB1C,MAAQhD,KAAKV,KAAK0D,MACxC0C,sBAAsBX,KAAO,OAC7BW,sBAAsBM,WAAalF,EAAEC,KAAKC,UAAU,YACpD0E,sBAAsB1C,MAAQhD,KAAKV,KAAK0D,MACxC0C,sBAAsBX,KAAO,OACzBtG,EAAE,oBAAoBwH,OAAS,EAC/BT,aAAe,2BACfC,QAAUC,0BACP,CACHF,aAAe,+BACf,IAAIU,0BAA4B,GAChCA,0BAA0BzF,SAAWA,SACrCyF,0BAA0BC,WAAY,EACtCD,0BAA0BE,aAAc,EACxCF,0BAA0BG,SAAWX,sBACrCD,QAAUS,0BAGdhH,UAAUoH,OAAOd,aAAcC,SAASvF,MAAK,SAASqG,KAC9C9H,EAAE,oBAAoBwH,OAAS,EAC/BxH,EAAE,2BAA2B2B,OAAOmG,KAEpC9H,EAAE,uBAAuB+H,QAAQD,KAGrC9H,EAAE,uBAAuBwD,YAAY,QAAQwE,SAAS,QACtDhI,EAAE,uBAAyBgC,UAAUH,KAAK,WAErB,QAAlBN,KAAKV,KAAKyF,OACjB3F,OAAOgG,cAAc9C,EAAE,IACvBiD,IAAMvF,KAAKV,KAAKiG,IAChB9G,EAAE,eAAiB8G,KAAKmB,KAAKvG,KAAKA,KAAK0F,WACvCpH,EAAE,IAAM8G,KAAKoB,QAAQ,iBAGD,mBAApBnH,KAAKF,KAAKuB,QAClBpC,EAAE,IAAMe,KAAKE,aAAa0B,OAAO,SACjC1C,IAAI0D,WAAW,gBAAiB,uBAAuBC,MAAK,SAASC,GACjElD,OAAOgG,cAAc9C,OAGzBsE,OAAOC,SAASC,UAWhCzH,UAAUO,UAAUmH,4BAA8B,aAYlD1H,UAAUO,UAAUmD,eAAiB,SAASiE,MAC1C,GAAIC,qBAEA,OADAxI,EAAE,IAAMe,KAAKE,aAAa0B,OAAO,WAAWS,UACrC,EAIXrC,KAAKF,KAAKuE,aAAepF,EAAEuI,MAAME,YACjC,IAAIlH,KAAOR,KACGV,KAAKkF,KAAK,CACpB1E,KAAME,KAAKF,KACXC,IAAKC,KAAKD,MAENW,MAAK,SAASiH,UAClB,OAAOnH,KAAKiE,6BAA6BkD,aAC1CxD,MAAK,gBAWZtE,UAAUO,UAAUwH,WAAa,SAASvE,GACtCA,EAAEC,iBACFtD,KAAKK,MAAMwH,UAAUrF,KAAK,QAAQsF,UAGW,CAU7C3H,KAAM,SAASL,KAAMC,KACjB,OAAO,IAAIF,UAAUC,KAAMC,MAGvC"}