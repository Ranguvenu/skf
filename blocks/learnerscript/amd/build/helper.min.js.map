{"version":3,"file":"helper.min.js","sources":["../src/helper.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n\n/**\n * Define the function with a clear and descriptive name, and then call it from other functions or code blocks as needed\n *\n * @module     block_learnerscript/helper\n * @copyright  2023 Moodle India Information Solutions Private Limited\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery',\n        'block_learnerscript/ajax',\n        'block_learnerscript/ajaxforms',\n        'core/str',\n        'core/modal_factory',\n        'core/modal_events',\n        'core/ajax',\n        'core/notification',\n        'block_learnerscript/bootstrapnotify/bootstrapnotify',\n        'block_learnerscript/smartfilter',\n    ],\n    function($, ajax, AjaxForms, Str, ModalFactory, ModalEvents, Ajax, notification, bootstrapnotify, smartfilter) {\n        var helper = {\n            rolepermissions: function() {\n                $('.rolepermissionsform').change(function(e) {\n                    var contextlevel = e.target.value;\n                    var reportid = $(this).data('reportid');\n                    require(['block_learnerscript/helper'], function(report) {\n                        helper.rolesforcontext(contextlevel, reportid);\n                    });\n                });\n            },\n            sendmessage: function(args, username) {\n                    Str.get_strings([{\n                    key: 'sendmessage',\n                    component: 'block_learnerscript'\n                }, {\n                    key: 'messageconfirmation',\n                    component: 'block_learnerscript'\n                }, {\n                    key: 'messagesent',\n                    component: 'block_learnerscript'\n                }, {\n                    key: 'supplyvalue',\n                    component: 'block_learnerscript'\n                }, {\n                    key: 'messagesending',\n                    component: 'block_learnerscript'\n                }, {\n                    key: 'close',\n                    component: 'block_learnerscript'\n                }, {\n                    key: 'submit',\n                    component: 'moodle'\n                }]).then(function(s) {\n                var userid = args.userid;\n                var reportinstance = args.reportinstance;\n                var formid = \"form_sendsms\" + userid;\n                var container = $(\"#sendsms_\" + reportinstance + '_' + userid).parents('table');\n                if ($('#ls_sendsms_' + reportinstance + '_' + userid).length < 1) {\n                    $(\"#sendsms_\" + reportinstance + '_' + userid).append('<div id=\"ls_sendsms_' + reportinstance + '_' +\n                    userid + '\" class=\"sendmessage\"><div class=\"messageloading\"></div><form id=\"' + formid +\n                    '\" ><textarea id=\"text_' + formid +\n                    '\" type=\"text\" name=\"message\"></textarea><input type=\"submit\" value = \"' + s[6] + '\"></form></div>');\n                }\n                var dlg = $('#ls_sendsms_' + reportinstance + '_' + userid).dialog({\n                    resizable: true,\n                    autoOpen: false,\n                    width: \"20%\",\n                    title: s[0],\n                    modal: false,\n                    dialogClass: 'sendsmsdialog',\n                    show: {\n                        effect: \"slide\",\n                        duration: 1000\n                    },\n                    position: {\n                        my: \"left\",\n                        at: \"right\",\n                        of: \"#sendsms_\" + reportinstance + '_' + userid,\n                        within: container\n                    },\n                    open: function() {\n                        $(this).closest(\".ui-dialog\")\n                            .find(\".ui-dialog-titlebar-close\")\n                            .removeClass(\"ui-dialog-titlebar-close\")\n                            .html(\"<span class='ui-button-icon-primary ui-icon ui-icon-closethick'></span>\");\n                            var Closebutton = $('.ui-icon-closethick').parent();\n                            $(Closebutton).attr({\n                                \"title\": s[5]\n                            });\n                        $(\".sendmessage\").not(this).each(function() {\n                            $(this).remove();\n                        });\n                    },\n                    close: function() {\n                        $(this).dialog('destroy').remove();\n                    }\n                });\n                dlg.dialog(\"open\");\n                $(\"#\" + formid).submit(function(e) {\n                    e.preventDefault();\n                    var helper = require('block_learnerscript/helper');\n                    var emptymessage = document.getElementById(\"text_\" + formid).value;\n                    if (!emptymessage) {\n                        $('.messageloading').html('<div class=\"alert alert-danger\">' + s[3] + '</div>');\n                    } else {\n                        var url = require('core/url');\n                        $('.messageloading').html('<center><img src=\"' + url.imageUrl(\"loader\", \"block_learnerscript\") +\n                        '\" alt=\"' + s[4] + '\" title=\"' + s[4] + '\"/></center>');\n                        $(\"#\" + formid).hide();\n                        var promise = Ajax.call([{\n                            methodname: 'core_message_send_instant_messages',\n                            args: {\n                                messages: [{\n                                    touserid: args.userid,\n                                    text: $(\"#\" + formid).serializeObject().message,\n                                    textformat: 0\n                                }]\n                            }\n                        }]);\n                        promise[0].done(function() {\n                            var message = s[2] + username;\n                            helper.notifications(message);\n                            dlg.dialog(\"close\");\n                        }).fail(function(ex) {\n                            // Do something with the exception\n                            $('.messageloading').html('<div class=\"alert alert-warning\">' + ex.message + '</div>');\n                        });\n                    }\n                });\n                return 'true';\n            }).fail();\n            },\n            ViewReportFilters: function(args) {\n                $('.' + args.activefilter).toggleClass(\"show\");\n                $('.' + args.inactivefilter).removeClass(\"show\");\n            },\n            deleteConfirm: function(args) {\n                return Str.get_strings([{\n                    key: 'deleteconfirmation',\n                    component: 'block_learnerscript'\n                }, {\n                    key: 'deleteallconfirm',\n                    component: 'block_learnerscript'\n                }, {\n                    key: 'confirm',\n                    component: 'block_learnerscript'\n                }, {\n                    key: 'close',\n                    component: 'block_learnerscript'\n                }]).then(function(s) {\n                    ModalFactory.create({\n                        title: s[0],\n                        type: ModalFactory.types.SAVE_CANCEL,\n                        body: s[1]\n                    }).done(function(modal) {\n                        this.modal = modal;\n                        modal.setSaveButtonText(s[2]);\n                        modal.getRoot().on(ModalEvents.save, function(e) {\n                            e.preventDefault();\n                            var helper = require('block_learnerscript/helper');\n                            var promise = Ajax.call([{\n                                methodname: 'block_learnerscript_' + args.action,\n                                args: args\n                            }]);\n                            promise[0].done(function() {\n                                $('.plotgraphcontainer').removeClass('show').addClass('hide');\n                                $('#plotreportcontainer' + args.reportid).html('');\n                                var tabdata = $('#' + args.cid).attr('aria-controls');\n                                $(\"[data-cid='\" + args.cid + \"']\").remove();\n                                $('#' + tabdata).remove();\n                                if ($(\"#report_plottabs li:eq(0) a\").length < 1) {\n                                    $('#report_plottabs').remove();\n                                }\n\n                                helper.notifications(s[2]);\n                            }).fail();\n                            modal.hide();\n                            modal.destroy();\n                        });\n                        modal.show();\n                        $('.modal-header button.close').attr('title', s[3]);\n                    }.bind(this));\n                }.bind(this));\n            },\n            validatebasicform: function(validate) {\n                var getreport = [];\n                if (typeof validate == 'undefined') {\n                    $.each($('.basicparamsform select'), function(index, value) {\n                        var selectedval = $(value).val();\n                        if (selectedval == 0) {\n                            getreport.push(0);\n                        }\n                    });\n                }\n                return getreport;\n            },\n            Preview: function(args) {\n                $(args.container).dialog({\n                    dialogClass: 'previewpopup',\n                    width: '95%',\n                    modal: true,\n                    position: {\n                        my: 'center',\n                        at: 'center',\n                        within: '.ls_components'\n                    },\n                    close: function() {\n                        $(this).dialog('destroy');\n                    },\n                    open: function() {\n                        $(this).closest(\".ui-dialog\")\n                            .find(\".ui-dialog-titlebar-close\")\n                            .removeClass(\"ui-dialog-titlebar-close\")\n                            .html(\"<span class='ui-button-icon-primary ui-icon ui-icon-closethick'></span>\");\n                        var Closebutton = $('.ui-icon-closethick').parent();\n                        Str.get_string('close', 'block_learnerscript').then(function(s){\n                            $(Closebutton).attr({\n                                \"title\" : s\n                            });\n                        });\n                    }\n                });\n            },\n            /**\n             * Central method for call Select2 with Ajax in reports module\n             * @param {object} args Object with reportID and other required params\n             */\n            Select2Ajax: function(args) {\n                $(\"select[data-select2-ajax='1']\").each(function() {\n                    var instanceid = $(this).data('instanceid');\n                    var reportinstance = instanceid ? instanceid : args.reportid;\n                    if (args.action == 'rolewiseusers') {\n                        args.reportid = $(this).data('reportid');\n                        args.courses = $('[name=\"filter_courses\"]').val();\n                    }\n                    if (args.action === 'userlist') {\n                        args.setminimuminputlength = 2;\n                        args.courses = $('[name=\"filter_courses\"]').val();\n                    }\n                    if (!$(this).hasClass('select2-hidden-accessible')) {\n                        var $blockname;\n                        var methodname2;\n                        $(this).select2({\n                            ajax: {\n                                data: function(params) {\n                                    var dataaction = $(this).data('action');\n                                    if (dataaction == 'filterusers' || dataaction == 'filter_courses') {\n                                        args.action = dataaction;\n                                        args.basicparamdata = JSON.stringify(smartfilter.BasicparamsData(reportinstance));\n                                        args.fiterdata = JSON.stringify(smartfilter.FilterData(reportinstance));\n                                        args.reportinstanceid = instanceid;\n                                        args.courses = $('[name=\"filter_courses\"]').val();\n\n                                    }\n                                    if (args.action == 'rolewiseusers') {\n                                        delete args.schuserslist;\n                                        delete args.scheduleid;\n                                        args.roleid = $(\"#id_role\" + reportinstance).val();\n                                        var roleid = args.roleid.split('_');\n                                        args.roleid = roleid[0];\n                                        args.contextlevel = roleid[1];\n                                        args.courses = $('[name=\"filter_courses\"]').val();\n\n                                    }\n                                    $.extend(params, args);\n                                    methodname2 = args.action;\n                                    if (methodname2 === 'userlist') {\n                                        $blockname = 'block_reportdashboard_';\n                                    } else {\n                                        $blockname = 'block_learnerscript_';\n                                    }\n\n                                    return params;\n                                },\n                                transport: function(params, success) {\n                                    var promise = Ajax.call([{\n                                        methodname: $blockname + methodname2,\n                                        args: params.data\n                                    }]);\n                                    promise[0].done(function(data) {\n                                        data = $.parseJSON(data);\n                                        success(data);\n                                    });\n                                    promise[0].fail(function() {\n                                        // Do something with the exception\n                                    });\n                                },\n                                processResults: function(data, params) {\n                                    // Parse the results into the format expected by Select2\n                                    // since we are using custom formatting functions we do not need to\n                                    // alter the remote JSON data, except to indicate that infinite\n                                    // scrolling can be used\n                                    params.page = params.page || 1;\n                                    var pagination = false;\n                                    if (args.action === 'userlist' || args.action == 'filter_courses'\n                                    || args.action == 'filterusers') {\n                                        pagination = false;\n                                    } else {\n                                        pagination = (params.page * 10) < data.total_count;\n                                    }\n                                    return {\n                                        results: data.items,\n                                        pagination: {\n                                                more: pagination\n                                        }\n                                    };\n                                }\n                            },\n                            escapeMarkup: function(markup) {\n                                return markup;\n                            }, // Let our custom formatter work\n                            minimumInputLength: args.setminimuminputlength || 1,\n                            maximumselectionlength: args.maximumselectionlength,\n                            language: {\n                                // You can find all of the options in the language files provided in the\n                                // build. They all must be functions that return the string that should be\n                                // displayed.\n                                maximumSelected: function(params) {console.log(args.action);\n                                    if (args.action == 'rolewiseusers') {\n                                        args.roleid = $(\"#id_role\" + reportinstance).val();\n                                        args.schuserslist = $('#schuserslist' + reportinstance).val();\n                                        args.scheduleid = $(\"#scheduleid\").val() || -1;\n                                        return \"Click <a href='javascript:void(0);' class='seluser' id='addusers\" + args.reportid + \"' \\\n                                                     data-reportid=\" + args.reportid + \" data-scheduleid = \" + args.scheduleid + \" \\\n                        onclick = '(function(e){ require(\\\"block_learnerscript/schedule\\\").manageschusers(\\\n                                                     {reportinstance:\" + reportinstance + \", reportid:\" + args.reportid + \",scheduleid:\" + args.scheduleid + \",selectedroleid:\" + args.roleid + \",\\\n                                                     schuserslist:\\\"\" + args.schuserslist + \"\\\"}) })(event)' > here </a> to add more than \" + params.maximum + \" users.\";\n                                    } else if (args.action == 'filter_courses' || args.action == 'filterusers') {\n                                        return 'You can select only 5 values';\n                                    }\n                                }\n                            },\n                            templateResult: function formatRepo(repo) {\n                                var markup;\n                                    if (repo.loading) {\n                                        return repo.text || Str.get_string('value_not_supported', 'block_learnerscript');\n                                    }\n                                    markup = repo.text || Str.get_string('value_not_supported', 'block_learnerscript');\n\n                                return markup;\n                            }, // Omitted for brevity, see the source of this page\n                            templateSelection: function formatRepoSelection(repo) {\n                                var markup;\n                                if (repo.id == -1 && args.action == 'rolewiseusers') {\n                                    var reportid = repo.element.form.dataset.reportid || 0;\n                                    var scheduleid = repo.element.form.dataset.scheduleid || -1;\n                                    markup = \"<a href='javascript:void(0)' class='viewschusers'\" +\n                                        \"onclick='(function(e){ require(\\\"block_learnerscript/schedule\\\").viewschusers(\" +\n                                        \"{reportid:\" + reportid + \",scheduleid:\" + scheduleid + \", reportinstance:\" +\n                                        reportinstance + \"}) })(event);'>\" + repo.text + \"</a>\";\n                                } else {\n                                    markup = repo.text;\n                                }\n                                return markup;\n                            } // Omitted for brevity, see the source of this page\n                        }).on('select2:select', function() {\n                            if (args.action == 'reportlist') {\n                                var reportid = $(this).val();\n                                window.location = M.cfg.wwwroot + '/blocks/learnerscript/viewreport.php?id=' + reportid;\n                            }\n                        });\n                    }\n                });\n            },\n            getQueryParameters: function(str) {\n                return (str || document.location.search).replace(/(\\?)/, '&').split(\"&\").map(function(n) {\n                    n = n.split(\"=\");\n                    this[n[0]] = n[1];\n                    return this;\n                }.bind({}))[0];\n            },\n            DrilldownReport: function() {\n                var self = this;\n                // Drill down report\n                $('td a').click(function(e) {\n                    var url = $(this).attr('href');\n                    var drillurl = self.getQueryParameters(url);\n                    if (url.indexOf('viewreport.php') <= 0 || \"download\" in drillurl) {\n                        return;\n                    }\n                    e.preventDefault();\n                    self.ReportModelFromLink({container: $(this), url: url});\n\n                });\n            },\n            ReportModelFromLink: function(args) {\n                var tableid = args.container.parents().closest('table').attr('id');\n                var tablewidth = $(\"#\" + tableid + \"\").width();\n                var drillurl = this.getQueryParameters(args.url);\n                var reportid = parseInt(drillurl.id);\n                var filter = {};\n                if (args.url.indexOf('viewreport.php') <= 0 || \"download\" in drillurl) {\n                    return;\n                }\n                $.each(drillurl, function(key, val) {\n                    if (key.indexOf('filter') >= 0) {\n                        filter[key] = val;\n                    }\n                });\n                if ($(\"#reportcontainer\" + reportid).length == 0 || $(\"#plotreportcontainer\" + reportid).length == 0) {\n                    $('body').append('<div id=\"reportcontainer' + reportid + '\" style=\"display:none;\"></div>');\n                    $('body').append('<div id=\"plotreportcontainer' + reportid +\n                    '\" class=\"dialogplot\" style=\"display:none;\"></div>');\n                    var promise = ajax.call({\n                        args: {\n                            action: 'disablecolumnstatus',\n                            reportid: reportid\n                        },\n                        url: M.cfg.wwwroot + \"/blocks/learnerscript/ajax.php\",\n                    });\n                    var dialogid;\n                    promise.done(function(response) {\n                        var reporttypes = response;\n                        require(['block_learnerscript/reportwidget'], function(reportwidget) {\n                            reportwidget.CreateDashboardwidget({\n                                reportid: reportid,\n                                reporttype: response,\n                                basicparams: JSON.stringify(filter),\n                                lsfstartdate: 0,\n                                lsfenddate: $.now(),\n                            });\n                        });\n                        if (reporttypes == 'table') {\n                            dialogid = \"reportcontainer\";\n                        } else {\n                            dialogid = \"plotreportcontainer\";\n                        }\n                        var dlg = $(\"#\" + dialogid + reportid + \"\").dialog({\n                            resizable: true,\n                            autoOpen: false,\n                            dialogClass: \"drilldown\" + reportid,\n                            width: tablewidth,\n                            title: '',\n                            appendTo: \"#\" + tableid,\n                            modal: true,\n                            position: {\n                                my: \"center\",\n                                at: \"top\",\n                                of: \"#\" + tableid\n                            },\n                            open: function() {\n                                Str.get_strings([{\n                                    key: 'close',\n                                    component: 'block_learnerscript'\n                                },{\n                                    key: 'viewmore',\n                                    component: 'block_learnerscript'\n                                }]).then(function(s){\n                                    $(this).closest(\".ui-dialog\")\n                                    .find(\".ui-dialog-titlebar-close\")\n                                    .removeClass(\"ui-dialog-titlebar-close\")\n                                    .html(\"<span class='ui-button-icon-primary ui-icon ui-icon-closethick'></span>\");\n                                    var Closebutton = $('.ui-icon-closethick').parent();\n                                    $(Closebutton).attr({\n                                        \"title\": s[0]\n                                    });\n                                    $(\".drilldown\" + reportid).append('<a href=' + args.url +\n                                    '><span class=\"reportdashboard_right\">' + s[1] + '</span></a>');\n                                });\n\n                            },\n                            close: function() {\n                                $(this).dialog('destroy').remove();\n                            }\n                        });\n                        dlg.dialog(\"open\").prev(\".ui-dialog-titlebar\").css(\"color\", \"#0C75B6\");\n                    });\n                }\n            },\n            PlotForm: function(args) {\n                Str.get_string('plot_graph', 'block_learnerscript').then(function(s){\n                    var url = M.cfg.wwwroot + '/blocks/learnerscript/ajax.php';\n                    args.title = (!args.title) ? s : args.title;\n                    AjaxForms.init(args, url);\n                });\n            },\n            reportCalculations: function(args) {\n                Str.get_string('calcs','block_learnerscript').then(function(s) {\n                var dlg = $(\".reportcalculation\" + args.reportid).dialog({\n                    dialogClass: 'calculationspopup',\n                    resizable: false,\n                    autoOpen: false,\n                    width: \"50%\",\n                    title: s,\n                    modal: true,\n                    position: {\n                        my: \"center\",\n                        at: \"center\",\n                        of: window\n                    },\n                    open: function() {\n                        $(\".reportcalculation\" + args.reportid).append('<img src=\"' +\n                        M.util.image_url('loading', 'block_learnerscript') + '\" id=\"loadingimage\" />');\n                        $(document).ajaxStop(function() {\n                            $(\"#loadingimage\").remove();\n                        });\n                        $(this).closest(\".ui-dialog\").find(\".ui-dialog-titlebar-close\")\n                            .removeClass(\"ui-dialog-titlebar-close\")\n                            .html(\"<span class='ui-button-icon-primary ui-icon ui-icon-closethick'></span>\");\n                            var Closebutton = $('.ui-icon-closethick').parent();\n                            $(Closebutton).attr({\n                                \"title\" : \"Close\"\n                            });\n                        $(this).closest(\".ui-dialog\").find('.ui-dialog-title')\n                            .html('Calculations');\n                    }\n\n                });\n                args.filters = smartfilter.FilterData(args.reportid);\n                args.filters['lsfstartdate'] = $('#lsfstartdate').val();\n                args.filters['lsfenddate'] = $('#lsfenddate').val();\n                if (typeof args.filters['filter_courses'] == 'undefined') {\n                    var filter_courses = $('#ls_courseid').val();\n                    if (filter_courses != 1) {\n                        args.filters['filter_courses'] = filter_courses;\n                    }\n                }\n                args.filters = JSON.stringify(args.filters);\n\n                args.action = 'reportcalculations';\n\n                args.basicparams = args.basicparams || JSON.stringify(smartfilter.BasicparamsData(args.reportid));\n                var promise = ajax.call({\n                    args: args,\n                    url: M.cfg.wwwroot + \"/blocks/learnerscript/ajax.php\"\n                });\n                promise.done(function(response) {\n                    $(\".reportcalculation\" + args.reportid).closest(\".ui-dialog\").find('.ui-dialog-title')\n                        .html(response.reportname + ' : Calculations');\n                    $(\".reportcalculation\" + args.reportid).html(response.table);\n                }).fail(function() {\n                });\n                dlg.dialog(\"open\");\n                }.bind(this));\n            },\n            dropdown: function(child) {\n                $('#' + child).toggle();\n            },\n            notifications: function(elements, notifytype) {\n                notifytype = notifytype || 'success';\n                $.notify({\n                    message: elements\n                }, {\n                    type: notifytype\n                }\n                );\n            },\n            tabsdraggable: function() {\n                $( \".ls-plotgraphs_list\" ).sortable({\n                    cursor: 'move',\n                    axis: 'y',\n                    update: function () {\n                        var elementsorder = $('.ls-plotgraphs_list').sortable('toArray', {attribute: 'data-cid'}).toString();\n                        ajax.call({\n                            args: {\n                                action: 'tabsposition',\n                                reportid: $('.ls-plotgraphs_list').data('reportid'),\n                                component: 'plot',\n                                elementsorder: elementsorder\n                            },\n                            url: M.cfg.wwwroot + \"/blocks/learnerscript/ajax.php\"\n                        });\n                    }\n                });\n            },\n            rolesforcontext: function(contextlevel, reportid) {\n                var promise = ajax.call({\n                    args: {\n                        action: 'contextroles',\n                        contextlevel: contextlevel,\n                        reportid: reportid\n                    },\n                    url: M.cfg.wwwroot + \"/blocks/learnerscript/ajax.php\",\n                });\n                promise.done(function(response) {\n                    var template = '';\n                    $.each(response, function(key, value) {\n                        template += '<option value = ' + key + '>' + value + '</option>';\n                    });\n                    $(\"#id_roleid\").find('option').remove().end().append(template);\n                });\n            }\n        };\n        return helper;\n    });\n"],"names":["define","$","ajax","AjaxForms","Str","ModalFactory","ModalEvents","Ajax","notification","bootstrapnotify","smartfilter","helper","rolepermissions","change","e","contextlevel","target","value","reportid","this","data","require","report","rolesforcontext","sendmessage","args","username","get_strings","key","component","then","s","userid","reportinstance","formid","container","parents","length","append","dlg","dialog","resizable","autoOpen","width","title","modal","dialogClass","show","effect","duration","position","my","at","of","within","open","closest","find","removeClass","html","Closebutton","parent","attr","not","each","remove","close","submit","preventDefault","document","getElementById","url","imageUrl","hide","call","methodname","messages","touserid","text","serializeObject","message","textformat","done","notifications","fail","ex","ViewReportFilters","activefilter","toggleClass","inactivefilter","deleteConfirm","create","type","types","SAVE_CANCEL","body","setSaveButtonText","getRoot","on","save","action","addClass","tabdata","cid","destroy","bind","validatebasicform","validate","getreport","index","val","push","Preview","get_string","Select2Ajax","$blockname","methodname2","instanceid","courses","setminimuminputlength","hasClass","select2","params","dataaction","basicparamdata","JSON","stringify","BasicparamsData","fiterdata","FilterData","reportinstanceid","schuserslist","scheduleid","roleid","split","extend","transport","success","promise","parseJSON","processResults","page","pagination","total_count","results","items","more","escapeMarkup","markup","minimumInputLength","maximumselectionlength","language","maximumSelected","console","log","maximum","templateResult","repo","loading","templateSelection","id","element","form","dataset","window","location","M","cfg","wwwroot","getQueryParameters","str","search","replace","map","n","DrilldownReport","self","click","drillurl","indexOf","ReportModelFromLink","tableid","tablewidth","parseInt","filter","response","reporttypes","reportwidget","CreateDashboardwidget","reporttype","basicparams","lsfstartdate","lsfenddate","now","appendTo","prev","css","PlotForm","init","reportCalculations","util","image_url","ajaxStop","filters","filter_courses","reportname","table","dropdown","child","toggle","elements","notifytype","notify","tabsdraggable","sortable","cursor","axis","update","elementsorder","attribute","toString","template","end"],"mappings":"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"}