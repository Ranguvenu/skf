{"version":3,"file":"chart.min.js","sources":["../src/chart.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Describe different types of charts.\n *\n * @module     block_learnerscript/chart\n * @copyright  2023 Moodle India Information Solutions Private Limited\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\ndefine(['jquery',\n        'core/ajax',\n        'block_learnerscript/charts/chart',\n        'block_learnerscript/smartfilter',\n        'block_learnerscript/report',\n        'core/str'\n    ],\n    function($, Ajax, Chart, smartfilter, report, Str) {\n        /**\n         * Get highchart report for report with Ajax request\n         * @param object reportid and reportdata\n         * @return Generate highchart report\n         */\n        var chart = {\n            HighchartsAjax: function(args) {\n                args.cols = JSON.stringify(args.cols);\n                args.instanceid = args.reportid;\n                args.filters = args.filters || smartfilter.FilterData(args.instanceid);\n                args.basicparams = JSON.stringify(smartfilter.BasicparamsData(args.instanceid));\n                args.filters['lsfstartdate'] = $('#lsfstartdate').val();\n                args.filters['lsfenddate'] = $('#lsfenddate').val();\n                if (typeof args.filters['filter_courses'] == 'undefined') {\n                    var filter_courses = $('.dashboardcourses').val();\n                    if (filter_courses != 1) {\n                        args.filters['filter_courses'] = filter_courses;\n                    }\n                }\n                args.filters = JSON.stringify(args.filters);\n\n                // Request\n                var promise = Ajax.call([{\n                    methodname: 'block_learnerscript_generate_plotgraph',\n                    args: args,\n                }]);\n\n                // Preload\n                $('#report_plottabs').show();\n                $(\"#plotreportcontainer\" +\n                args.instanceid).html('<img src=\"' +\n                M.util.image_url('loading', 'block_learnerscript') + '\" id=\"reportloadingimage\" />');\n\n                // Response process\n                   promise[0].done(function(response) {\n                        response = JSON.parse(response);\n                        if (response.plot) {\n                            if (response.plot.error === true) {\n                                Str.get_string('nodataavailable', 'block_learnerscript').then(function(s) {\n                                    $('#plotreportcontainer' +\n                                    args.instanceid).html(\"<div class='alert alert-warning'>\" + s + \"</div>\");\n                                });\n                            } else {\n                                response.plot.reportid = args.reportid;\n                                response.plot.reportinstance = args.reportid;\n                                if (response.plot.data && response.plot.data.length > 0) {\n                                    require(['block_learnerscript/report'], function(report) {\n                                        report.generate_plotgraph(response.plot);\n                                    });\n                                } else {\n                                    Str.get_string('nodataavailable', 'block_learnerscript').then(function(s) {\n                                        $('#plotreportcontainer' +\n                                        args.instanceid).html(\"<div class='alert alert-warning'>\" + s + \"</div>\");\n                                    });\n                                }\n                            }\n                            $(document).ajaxStop(function() {\n                                $(\"#reportloadingimage\").remove();\n                            });\n                        }\n                    });\n            },\n            combinationchart: function(chartdata) {\n                var canvas = document.createElement('canvas');\n                var random = Math.random();\n                canvas.id = \"mixedcanvas\" + random;\n                var body = document.getElementById(chartdata.containerid);\n                body.appendChild(canvas);\n                var cursorlayer = document.getElementById(\"mixedcanvas\" + random).getContext(\"2d\");\n                new Chart(cursorlayer, {\n                    type: 'bar',\n                    data: {\n                        datasets: chartdata.data,\n                        labels: chartdata.categorydata\n                    }\n                });\n            },\n            lbchart: function(chartdata) {\n                if (chartdata.type == 'bar') {\n                    var canvas = document.createElement('canvas');\n                    var random = Math.random();\n                    canvas.id = \"canvaschart\" + random;\n                    var body = document.getElementById(chartdata.containerid);\n                    body.appendChild(canvas);\n                    var cursorlayer = document.getElementById(\"canvaschart\" + random).getContext(\"2d\");\n                    new Chart(cursorlayer, {\n                        type: 'bar',\n                        data: {\n                            datasets: chartdata.data,\n                            labels: chartdata.categorydata\n                        },\n                        options: {\n                            indexAxis: 'y',\n                        }\n                    });\n                } else {\n                    var canvas = document.createElement('canvas');\n                    var random = Math.random();\n                    canvas.id = \"canvaschart\" + random;\n                    var body = document.getElementById(chartdata.containerid);\n                    body.appendChild(canvas);\n                    var cursorlayer = document.getElementById(\"canvaschart\" + random).getContext(\"2d\");\n                    new Chart(cursorlayer, {\n                        type: 'bar',\n                        data: {\n                            datasets: chartdata.data,\n                            labels: chartdata.categorydata\n                        }\n                    });\n                }\n            },\n            radarchart: function(chartdata) {\n                var canvas = document.createElement('canvas');\n                var random = Math.random();\n                canvas.id = \"radarcanvas\" + random;\n                var body = document.getElementById('testaccess');\n                body.appendChild(canvas);\n                var cursorlayer = document.getElementById(\"radarcanvas\" + random).getContext(\"2d\");\n                new Chart(cursorlayer, {\n                    type: 'radar',\n                    data: {\n                        datasets: chartdata.data,\n                        labels: chartdata.xAxis\n                    },\n                    options: {\n                        plugins: {\n                        legend: {\n                            position: 'top',\n                        },\n                        filler: {\n                            propagate: false\n                        },\n                        'samples-filler-analyser': {\n                            target: 'chart-analyser'\n                        }\n                        },\n                        interaction: {\n                            intersect: false\n                        }\n                    }\n                });\n            },\n            piechart: function(chartdata) {\n                var canvas = document.createElement('canvas');\n                var random = Math.random();\n                canvas.id = \"myPieChart\" + random;\n                var body = document.getElementById(chartdata.containerid);\n                body.appendChild(canvas);\n                var ctx = document.getElementById('myPieChart' + random).getContext('2d');\n                new Chart(ctx, {\n                    type: 'pie',\n                    data: {\n                        labels: chartdata.data,\n                        datasets: [{\n                            data: chartdata.datalabels,\n                            backgroundColor: ['gold', 'yellowgreen', 'lightcoral', 'lightskyblue', 'violet']\n                        }]\n                    },\n                    options: {\n                        responsive: true,\n                        plugins: {\n                            legend: {\n                                position: 'top',\n                            },\n                            title: {\n                                display: true,\n                                text: chartdata.title\n                            }\n                        }\n                    }\n                });\n            },\n        };\n        return chart;\n    });\n"],"names":["define","$","Ajax","Chart","smartfilter","report","Str","chart","HighchartsAjax","args","cols","JSON","stringify","instanceid","reportid","filters","FilterData","basicparams","BasicparamsData","val","filter_courses","promise","call","methodname","show","html","M","util","image_url","done","response","parse","plot","error","get_string","then","s","reportinstance","data","length","require","generate_plotgraph","document","ajaxStop","remove","combinationchart","chartdata","canvas","createElement","random","Math","id","getElementById","containerid","appendChild","cursorlayer","getContext","type","datasets","labels","categorydata","lbchart","options","indexAxis","radarchart","xAxis","plugins","legend","position","filler","propagate","target","interaction","intersect","piechart","ctx","datalabels","backgroundColor","responsive","title","display","text"],"mappings":"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"}